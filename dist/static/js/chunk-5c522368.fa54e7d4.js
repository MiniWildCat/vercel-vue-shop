(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5c522368"],{"64ae":function(e,o,s){},8644:function(e,o,s){"use strict";s.r(o);var t=function(){var e=this,o=e._self._c;return o("div",{staticClass:"add-eval"},[o("div",{staticClass:"title"},[o("card",{attrs:{_Title:"商品投诉",_Size:16}}),o("p",[o("span",{staticClass:"color999"},[e._v("订单号：")]),o("span",[e._v(e._s(e.$route.query.sn))]),e.order.order?o("span",{staticClass:"color999 ml_20"},[e._v(e._s(e.order.order.paymentTime))]):e._e()])],1),o("div",{staticClass:"goods-eval"},[o("div",{staticClass:"goods-con"},[o("img",{staticClass:"hover-pointer",attrs:{src:e.orderGoods.image,alt:"",width:"100"},on:{click:function(o){return e.goGoodsDetail(e.orderGoods.skuId,e.orderGoods.goodsId)}}}),o("p",{staticClass:"hover-pointer color999",on:{click:function(o){return e.goGoodsDetail(e.orderGoods.skuId,e.orderGoods.goodsId)}}},[e._v(e._s(e.orderGoods.goodsName))]),o("p",[e._v(e._s(e._f("unitPrice")(e.orderGoods.goodsPrice,"￥")))])]),o("div",{staticClass:"eval-con"},[o("div",[o("span",{staticClass:"color999"},[e._v("投诉主题：")]),o("Select",{staticStyle:{width:"260px","margin-bottom":"10px"},model:{value:e.form.complainTopic,callback:function(o){e.$set(e.form,"complainTopic",o)},expression:"form.complainTopic"}},e._l(e.reasonList,(function(s){return o("Option",{key:s.id,attrs:{value:s.reason}},[e._v(e._s(s.reason))])})),1),o("Input",{attrs:{type:"textarea",maxlength:"500","show-word-limit":"",rows:4,placeholder:"请输入投诉内容"},model:{value:e.form.content,callback:function(o){e.$set(e.form,"content",o)},expression:"form.content"}})],1),o("div",{staticStyle:{display:"flex","align-items":"center"}},[e._l(e.orderGoods.uploadList,(function(s,t){return o("div",{key:t,staticClass:"demo-upload-list"},[o("img",{attrs:{src:s}}),o("div",{staticClass:"demo-upload-list-cover"},[o("Icon",{attrs:{type:"ios-eye-outline"},nativeOn:{click:function(o){return e.handleView(s)}}}),o("Icon",{attrs:{type:"ios-trash-outline"},nativeOn:{click:function(o){return e.handleRemove(t)}}})],1)])})),o("Upload",{staticStyle:{display:"inline-block",width:"58px"},attrs:{"show-upload-list":!1,"on-success":e.handleSuccess,"before-upload":e.handleBeforeUpload,format:["jpg","jpeg","png"],action:e.action,headers:e.accessToken}},[o("div",{staticClass:"hover-pointer icon-upload"},[o("Icon",{attrs:{type:"ios-camera",size:"20"}})],1)]),o("div",{staticClass:"describe"},[e._v("上传投诉凭证，最多5张")])],2)])]),o("Button",{staticClass:"mt_10",attrs:{type:"primary",loading:e.loading},on:{click:e.save}},[e._v("提交")]),o("Modal",{attrs:{title:"View Image"},model:{value:e.visible,callback:function(o){e.visible=o},expression:"visible"}},[e.visible?o("img",{staticStyle:{width:"100%"},attrs:{src:e.previewImage}}):e._e()])],1)},i=[],r=s("f8b7"),a=s("8194"),n=s("ff66"),d=s("e487"),c={data(){return{order:{},orderGoods:{},form:{complainTopic:"",content:""},visible:!1,action:n["c"]+"/common/common/upload/file",accessToken:{},previewImage:"",loading:!1,reasonList:[]}},methods:{getOrderDetail(){Object(r["j"])(this.$route.query.sn).then(e=>{this.order=e.result,this.orderGoods=e.result.orderItems[this.$route.query.index],this.orderGoods.uploadList=[]}),Object(a["f"])("COMPLAIN").then(e=>{e.success&&(this.reasonList=e.result,this.$set(this.form,"complainTopic",e.result[0].reason),this.$forceUpdate())})},save(){let e={goodsId:this.orderGoods.goodsId,complainTopic:this.form.complainTopic,content:this.form.content,images:this.orderGoods.uploadList.toString(),orderSn:this.$route.query.sn,skuId:this.orderGoods.skuId};Object(a["I"])(e).then(e=>{e.success&&(this.$Message.success("投诉申请已提交，感谢您的反馈"),this.$router.push({name:"ComplainList"}))})},goGoodsDetail(e,o){let s=this.$router.resolve({path:"/goodsDetail",query:{skuId:e,goodsId:o}});window.open(s.href,"_blank")},handleView(e){this.previewImage=e,this.visible=!0},handleRemove(e){this.orderGoods.uploadList.splice(e,1),this.$forceUpdate()},handleSuccess(e,o){this.orderGoods.uploadList.push(e.result),this.$forceUpdate()},handleBeforeUpload(){const e=this.orderGoods.uploadList.length<6;if(!e)return this.$Notice.warning({title:"最多可以上传五张图片"}),e}},mounted(){this.accessToken.accessToken=d["a"].getItem("accessToken"),this.getOrderDetail(),window.scrollTo(0,0)}},l=c,u=(s("d0a6"),s("2877")),p=Object(u["a"])(l,t,i,!1,null,"58c0eda0",null);o["default"]=p.exports},d0a6:function(e,o,s){"use strict";s("64ae")}}]);
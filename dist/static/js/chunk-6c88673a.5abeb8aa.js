(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6c88673a"],{1390:function(t,s,e){"use strict";e("47b4")},"1ddd":function(t,s,e){},"33d2":function(t,s,e){"use strict";e("b564")},"47b4":function(t,s,e){},7861:function(t,s,e){"use strict";var i=function(){var t=this,s=t._self._c;return s("div",["goodsDetail"===t.type?s("div",{staticClass:"wrapper"},[s("div",{staticClass:"wr-l"},[s("Icon",{attrs:{size:"23",type:"ios-alarm-outline"}}),t._v(" 秒杀活动")],1),""===t.end?s("div",{staticClass:"count-down"},[s("p",[t._v("倒计时：")]),s("span",[t._v(t._s(t.hours))]),s("span",[t._v(t._s(t.minutes))]),s("span",[t._v(t._s(t.seconds))])]):s("div",[t._v(t._s(t.end))])]):s("span",{staticClass:"cart-promotion"},[""===t.end?s("span",[t._v("距活动结束："),s("span",[t._v(t._s(t.hours))]),t._v(" : "),s("span",[t._v(t._s(t.minutes))]),t._v(" : "),s("span",[t._v(t._s(t.seconds))])]):s("span",[t._v("活动已结束")])])])},o=[],a={props:{time:{default:1718977559428},type:{default:"goodsDetail",type:String}},data(){return{end:"",hours:"",minutes:"",seconds:"",interval:""}},mounted(){this.init()},methods:{countDown(t){function s(t){return t<10?"0"+t:t+""}var e=new Date,i=new Date(t),o=parseInt((i.getTime()-e.getTime())/1e3),a=parseInt(o/3600%24),c=parseInt(o/60%60),n=parseInt(o%60);a=s(a),c=s(c),n=s(n),this.hours=a,this.minutes=c,this.seconds=n,o<=0&&(this.end="活动已结束",clearInterval(this.interval))},init(){this.interval=setInterval(()=>{this.countDown(this.time)},1e3)}}},c=a,n=(e("1390"),e("2877")),r=Object(n["a"])(c,i,o,!1,null,"d6d9a094",null);s["a"]=r.exports},b564:function(t,s,e){},ee17:function(t,s,e){"use strict";e("1ddd")},f68e:function(t,s,e){"use strict";e.r(s);var i=function(){var t=this,s=t._self._c;return s("div",{staticClass:"cart",on:{click:function(s){t.couponAvailable=!1}}},[s("BaseHeader"),s("div",{staticClass:"width_1200 logo"},[s("div",[s("router-link",{attrs:{to:"/"}},[s("img",{attrs:{src:t.$store.state.logoImg}})]),s("div",[t._v(" 购物车("),s("span",[t._v(t._s(t.goodsTotal))]),t._v(") ")])],1)]),s("Divider"),s("div",{staticClass:"cart-content width_1200 center"},[s("div",{staticClass:"available-area"},[s("div",{staticClass:"cart-steps"},[s("span",{class:0==t.stepIndex?"active":""},[t._v("1.我的购物车")]),s("Icon",{class:0==t.stepIndex?"active-arrow":"",attrs:{custom:"icomoon icon-next"}}),s("span",{class:1==t.stepIndex?"active":""},[t._v("2.填写订单信息")]),s("Icon",{class:1==t.stepIndex?"active-arrow":"",attrs:{custom:"icomoon icon-next"}}),s("span",{class:2==t.stepIndex?"active":""},[t._v("3.成功提交订单")])],1)]),s("div",{staticClass:"cart-goods"},[s("div",{staticClass:"cart-goods-title"},[s("div",{staticClass:"width_60"},[s("Checkbox",{on:{"on-change":function(s){return t.changeChecked(t.allChecked,"all")}},model:{value:t.allChecked,callback:function(s){t.allChecked=s},expression:"allChecked"}},[t._v("全选")])],1),s("div",{staticClass:"goods-title"},[t._v("商品")]),s("div",{staticClass:"width_150"},[t._v("单价（元）")]),s("div",{staticClass:"width_100"},[t._v("数量")]),s("div",{staticClass:"width_150"},[t._v("小计")]),s("div",{staticClass:"width_100"},[t._v("操作")])]),0===t.cartList.length?s("div",{staticClass:"cart-empty"},[s("p",[t._v("购物车空空如也")]),s("router-link",{attrs:{to:"/"}},[t._v("去选购>")])],1):t._l(t.cartList,(function(e,i){return s("div",{key:i,staticClass:"cart-goods-items"},[s("div",{staticClass:"shop-name"},[s("div",[s("Checkbox",{on:{"on-change":function(s){return t.changeChecked(e.checked,"shop",e.storeId)}},model:{value:e.checked,callback:function(s){t.$set(e,"checked",s)},expression:"shop.checked"}}),s("span",{staticClass:"go-shop-page",on:{click:function(s){return t.goShopPage(e.storeId)}}},[t._v(t._s(e.storeName))])],1),e.couponList.length?s("span",{staticClass:"shop-coupon",class:t.couponAvailable===i?"shop-coupon-show":"",on:{click:function(s){return s.stopPropagation(),t.showCoupon(e.id,i)}}},[t.couponAvailable===i?s("div",t._l(e.couponList,(function(e,i){return s("div",{key:i,staticClass:"coupon-item"},["PRICE"===e.couponType?s("span",[t._v("￥"+t._s(e.price))]):t._e(),"DISCOUNT"===e.couponType?s("span",[t._v(t._s(e.couponDiscount)+"折")]):t._e(),s("span",[t._v("满"+t._s(e.consumeThreshold)+"元可用")]),s("Button",{staticClass:"coupon-btn",attrs:{size:"small",type:"primary",disabled:e.disabled},on:{click:function(s){return t.receiveShopCoupon(e)}}},[t._v(t._s(e.disabled?"已领取":"领取"))])],1)})),0):t._e()]):t._e(),s("div",{staticClass:"promotion-notice"},[t._v(t._s(e.promotionNotice))])]),t._l(e.skuList,(function(e,i){return[s("div",{key:i,staticClass:"goods-item"},[s("div",{staticClass:"width_60"},[s("Checkbox",{on:{"on-change":function(s){return t.changeChecked(e.checked,"goods",e.goodsSku.id)}},model:{value:e.checked,callback:function(s){t.$set(e,"checked",s)},expression:"goods.checked"}})],1),s("div",{staticClass:"goods-title",on:{click:function(s){return t.goGoodsDetail(e.goodsSku.id,e.goodsSku.goodsId)}}},[s("img",{attrs:{src:e.goodsSku.thumbnail||"../assets/images/goodsDetail/item-detail-1.jpg"}}),s("div",[s("p",[t._v(" "+t._s(e.goodsSku.goodsName)+" ")]),s("p",["WHOLESALE"===e.goodsSku.salesModel?s("Tag",{staticClass:"goods-show-tag",attrs:{color:"purple"}},[t._v(" 批发商品 ")]):t._e()],1),t._l(e.promotions,(function(e,i){return["SECKILL"===e.promotionType?s("div",{key:i,staticClass:"promotion"},[s("span",[t._v("秒杀")]),s("promotion",{attrs:{time:e.endTime,type:"cart"}})],1):t._e()]})),t._l(e.promotions,(function(e,i){return["FULL_DISCOUNT"===e.promotionType?s("div",{key:i,staticClass:"promotion"},[s("span",[t._v("满优惠活动")]),s("promotion",{attrs:{time:e.endTime,type:"cart"}})],1):t._e()]}))],2)]),s("div",{staticClass:"width_150"},[t._v(" "+t._s(t._f("unitPrice")(e.purchasePrice,"￥"))+" ")]),s("div",{staticClass:"width_100"},[s("InputNumber",{attrs:{min:1,size:"small"},on:{"on-change":function(s){return t.changeNum(e.num,e.goodsSku.id)}},model:{value:e.num,callback:function(s){t.$set(e,"num",s)},expression:"goods.num"}}),s("div",{staticClass:"fontsize_12"},[t._v(" "+t._s(e.goodsSku.quantity>0?"有货":"无货")+" ")])],1),s("div",{staticClass:"width_150"},[t._v(" "+t._s(t._f("unitPrice")(e.subTotal,"￥"))+" ")]),s("div",{staticClass:"width_100"},[e.errorMessage?t._e():s("Button",{attrs:{size:"small",type:"primary"},on:{click:function(s){return t.delGoods(e.goodsSku.id)}}},[t._v("删除")]),e.errorMessage?t._e():s("Button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"info"},on:{click:function(s){return t.collectGoods(e.goodsSku.id)}}},[t._v("收藏")])],1),e.errorMessage?s("div",{staticClass:"error-goods"},[s("div",{staticStyle:{"margin-top":"20px"}},[t._v(t._s(e.errorMessage))]),s("Button",{attrs:{type:"primary"},on:{click:function(s){return t.delGoods(e.goodsSku.id)}}},[t._v("删除")])],1):t._e()])]}))],2)})),s("div",{staticClass:"cart-goods-footer"},[s("div",[s("div",{staticClass:"width_60"},[s("Checkbox",{on:{"on-change":function(s){return t.changeChecked(t.allChecked,"all")}},model:{value:t.allChecked,callback:function(s){t.allChecked=s},expression:"allChecked"}},[t._v("全选")])],1),s("div",{staticClass:"width_100 handle-btn",on:{click:function(s){return t.delGoods()}}},[t._v(" 删除选中商品 ")]),s("div",{staticClass:"width_100 handle-btn",on:{click:t.clearCart}},[t._v(" 清空购物车 ")])]),s("div",[s("div",{staticClass:"selected-count"},[t._v(" 已选择"),s("span",[t._v(t._s(t.checkedNum))]),t._v("件商品 ")]),s("div",{staticClass:"ml_20 save-price"},[t._v(" 已节省"),s("span",[t._v(t._s(t._f("unitPrice")(t.priceDetailDTO.discountPrice,"￥")))])]),s("div",{staticClass:"ml_20 total-price"},[t._v(" 总价（不含运费）: "),s("div",[t._v(t._s(t._f("unitPrice")(t.priceDetailDTO.flowPrice,"￥")))])]),s("div",{staticClass:"pay ml_20",on:{click:t.pay}},[t._v("去结算")])])])],2),t.loading?s("Spin",{attrs:{size:"large",fix:""}}):t._e()],1),s("BaseFooter",{staticClass:"footer"})],1)},o=[],a=e("7861"),c=e("c106"),n=e("2166"),r=e("8194"),l={name:"Cart",beforeRouteEnter(t,s,e){window.scrollTo(0,0),e()},components:{Search:c["a"],Promotion:a["a"]},data(){return{couponAvailable:!1,stepIndex:0,goodsTotal:0,checkedNum:0,allChecked:!1,loading:!1,cartList:[],couponList:[],priceDetailDTO:{},skuList:[]}},methods:{goGoodsDetail(t,s){let e=this.$router.resolve({path:"/goodsDetail",query:{skuId:t,goodsId:s}});window.open(e.href,"_blank")},goShopPage(t){let s=this.$router.resolve({path:"/Merchant",query:{id:t}});window.open(s.href,"_blank")},collectGoods(t){this.$Modal.confirm({title:"收藏",content:"<p>商品收藏后可在个人中心我的收藏查看</p>",onOk:()=>{r["p"]("GOODS",t).then(t=>{t.success&&(this.$Message.success("收藏商品成功"),this.getCartList())})},onCancel:()=>{}})},delGoods(t){const s=[];if(t)s.push(t);else{const t=this.cartList;t.forEach(t=>{t.skuList.forEach(t=>{t.checked&&s.push(t.goodsSku.id)})})}this.$Modal.confirm({title:"删除",content:"<p>确定要删除该商品吗？</p>",onOk:()=>{n["h"]({skuIds:s.toString()}).then(t=>{t.success?(this.$Message.success("删除成功"),this.getCartList()):this.$Message.error(t.message)})}})},clearCart(){this.$Modal.confirm({title:"提示",content:"<p>确定要清空购物车吗？清空后不可恢复</p>",onOk:()=>{n["e"]().then(t=>{t.success?(this.$Message.success("清空购物车成功"),this.getCartList()):this.$Message.error(t.message)})}})},pay(){this.checkedNum?this.$router.push({path:"/pay",query:{way:"CART"}}):this.$Message.warning("请至少选择一件商品")},showCoupon(t,s){this.couponAvailable=s},changeNum(t,s){t&&n["l"]({skuId:s,num:t}).then(t=>{t.success&&this.getCartList()})},async changeChecked(t,s,e){const i=t?1:0;"all"===s?await n["m"]({checked:i}):"shop"===s?await n["o"]({checked:i,storeId:e}):await n["n"]({checked:i,skuId:e}),this.getCartList()},async receiveShopCoupon(t){let s=await r["Q"](t.id);s.success?(this.$set(t,"disabled",!0),this.$Message.success("领取成功")):this.$Message.error(s.message)},async getCartList(){this.loading=!0;try{let t=await n["c"]();if(this.loading=!1,t.success){this.cartList=t.result.cartList,this.priceDetailDTO=t.result.priceDetailDTO,this.skuList=t.result.skuList,this.checkedNum=0;let s=!0;for(let t=0;t<this.cartList.length;t++){let s=this.cartList[t],e=await r["t"]({storeId:s.storeId});s.couponList.push(...e.result.records)}for(let t=0;t<this.skuList.length;t++)this.skuList[t].checked?this.checkedNum+=this.skuList[t].num:s=!1;this.$forceUpdate(),this.allChecked=s}}catch(t){this.loading=!1}}},mounted(){this.getCartList(),n["b"]().then(t=>{t.success&&(this.goodsTotal=t.result)})}},d=l,u=(e("ee17"),e("33d2"),e("2877")),h=Object(u["a"])(d,i,o,!1,null,"eb6bea46",null);s["default"]=h.exports}}]);